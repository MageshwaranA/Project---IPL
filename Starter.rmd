```{r libraries}
library(readr)
library(tidyverse)

```

<br>

```{r import deliveries}

Deliveries <- read_csv("dataset/Deliveries.csv")

```

<br>

#Cleaning data for batsman statistics in IPL

```{r Batting Stat Cleaning}

Matches_Played <- Deliveries %>%
  group_by(batsman) %>% 
  distinct(match_no,batsman) %>% 
  summarise(Matches_Played = n())

Runs <- Deliveries %>% 
  group_by(batsman) %>% 
  summarise(Runs = sum(batsman_run))

Out_matches <- Deliveries %>% 
  filter(Deliveries$is_wicket == 1) %>% 
  group_by(batsman) %>% 
  distinct(match_no,batsman) %>% 
  summarise(Out = n())

Ball_Faced <- Deliveries %>% 
  filter(extra_run == 0 | extra_type == "lb") %>% 
  group_by(batsman) %>% 
  summarise(Ball_Faced = n())

Score <- Deliveries %>% 
  group_by(batsman,match_no) %>% 
  summarise(S = sum(batsman_run))

HS <- Score %>% 
  group_by(batsman) %>% 
  summarise(HS = max(S))


Four <- Deliveries %>% 
  group_by(batsman) %>% 
  filter(batsman_run == 4) %>% 
  summarise(Four = n())

Six <- Deliveries %>% 
  group_by(batsman) %>% 
  filter(batsman_run == 6) %>% 
  summarise(Six = n())


Batting_Stat <- merge(Matches_Played,Runs, all = TRUE)

Batting_Stat <- merge(Batting_Stat, Out_matches, all = TRUE)

Batting_Stat$NO <- Batting_Stat$Matches_Played - Batting_Stat$Out

Batting_Stat <- merge(Batting_Stat, Ball_Faced, all = TRUE)

Batting_Stat <- merge(Batting_Stat, HS, all = TRUE)

Batting_Stat$Average <- Batting_Stat$Runs / Batting_Stat$Out

Batting_Stat$SR <- (Batting_Stat$Runs / Batting_Stat$Ball_Faced) * 100

Batting_Stat <- merge(Batting_Stat, Four, all = TRUE)

Batting_Stat <- merge(Batting_Stat, Six, all = TRUE)

Batting_Stat[is.na(Batting_Stat)] <- 0

```

<br>

#Visual representation of runs scored by each batsman

```{r Circular Bar chart for batsman}

CBC <- ggplot(Batting_Stat, aes(x = as.factor(batsman), y = Runs)) +
  geom_bar(stat = "identity", fill = alpha("red",0.4)) +
  ylim(-1,200) +
  theme_minimal() +
  theme(
    axis.text = element_text(size = 0.03),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.margin = unit(rep(-2,4), "cm")     # This remove unnecessary margin around plot
  ) +
  
  # This makes the coordinate polar instead of cartesian.
  coord_polar(start = 0)

CBC

```

